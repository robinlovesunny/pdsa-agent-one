# PDSA数字分身智能体 - 产品需求文档

## 基本信息

| 项目名称 | pdsa数字分身智能体 |
| --- | --- |
| 版本 | v1.0 |
| 创建日期 | 2025-11-15 |
| 目标用户 | 个人/小团队 |
| 技术栈 | Python Flask + HTML/CSS/JS + 阿里云百炼 |

## 1. 产品概述

### 1.1 产品定位

基于阿里云百炼RAG能力的轻量级个人知识库问答系统,通过Web界面提供智能对话服务。

### 1.2 核心价值

- ✅ 自动基于个人知识库回答问题
- ✅ 保护API密钥安全
- ✅ 简单易部署,适合新手
- ✅ 支持对话记忆
- ✅ 可扩展架构

### 1.3 技术架构

```
前端(HTML/CSS/JS) → Flask后端(API转发) → 阿里云百炼(RAG+LLM)
```
## 2. 功能需求

### 2.1 核心功能

#### F1: 智能对话

- **描述**: 用户通过Chatbox与AI助手对话
- **输入**: 用户文本消息
- **输出**: AI基于知识库的回答
- **优先级**: P0

#### F2: 知识库检索

- **描述**: 自动检索个人知识库中的相关内容
- **实现**: 使用阿里云百炼内置RAG能力
- **优先级**: P0

#### F3: 对话记忆

- **描述**: 维护对话上下文,支持多轮对话
- **实现**: 前端维护历史记录,传递给后端
- **优先级**: P0

#### F4: 对话日志

- **描述**: 记录所有对话到本地文件
- **用途**: 数据分析、问题追溯
- **优先级**: P1
### 2.2 非功能需求

| 需求类型 | 具体要求 |
| --- | --- |
| 性能 | 响应时间 < 3秒 |
| 安全 | API Key不暴露到前端 |
| 可用性 | 界面简洁直观,无需培训 |
| 可维护性 | 代码注释完整,结构清晰 |
| 扩展性 | 预留工具扩展接口 |

## 3. 系统设计

### 3.1 项目结构

```
digital-avatar-lite/
│
├── backend/                      # 后端目录
│   ├── app.py                   # Flask主程序(核心文件)
│   ├── requirements.txt         # Python依赖
│   ├── .env                     # 环境变量配置
│   └── chat_logs.txt           # 对话日志(自动生成)
│
├── frontend/                     # 前端目录
│   ├── index.html              # 主页面
│   └── app.js                  # 前端逻辑
│
├── docs/                        # 文档目录
│   └── README.md               # 使用说明
│
└── knowledge/                   # 知识库文件(上传到百炼)
    ├── about_me.md
    ├── skills.md
    └── projects.md
```

### 3.2 技术选型

| 层级 | 技术 | 理由 |
| --- | --- | --- |
| 前端 | 原生HTML/CSS/JS | 无需构建,简单直接 |
| 后端 | Flask | 轻量级,适合小项目 |
| AI服务 | 阿里云百炼 | 内置RAG,中文友好 |
| 部署 | 阿里云ECS | 与百炼同区域,速度快 |

### 3.3 API设计

#### 接口1: 对话接口

**请求**

```http
POST /api/chat
Content-Type: application/json
```

```json
{
    "message": "用户问题",
    "history": [
        {"user": "历史问题1", "bot": "历史回答1"},
        {"user": "历史问题2", "bot": "历史回答2"}
    ]
}
```

**响应**

```json
{
    "success": true,
    "reply": "AI回复内容"
}
```

#### 接口2: 健康检查

**请求**

```http
GET /api/health
```

**响应**

```json
{
    "status": "ok"
}
```

### 3.4 数据流设计

```
用户输入
   ↓
[前端验证]
   ↓
构建请求(含历史)
   ↓
[后端接收]
   ↓
调用百炼API
   ↓
[百炼RAG检索]
   ↓
[LLM生成回答]
   ↓
[后端记录日志]
   ↓
返回响应
   ↓
[前端展示]
   ↓
更新历史记录
```

## 4. 界面设计

### 4.1 整体布局

```
┌─────────────────────────────────┐
│         🤖 个人数字分身          │  ← Header
│      基于你的知识库回答问题       │
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────┐   │
│  │ AI: 你好!有什么可以...   │   │
│  └─────────────────────────┘   │
│                                 │
│           ┌───────────────┐    │
│           │ 用户: 你是谁?│    │  ← 消息区
│           └───────────────┘    │
│                                 │
│  ┌─────────────────────────┐   │
│  │ AI: 我是你的数字分身...   │   │
│  └─────────────────────────┘   │
│                                 │
├─────────────────────────────────┤
│  ┌───────────────────┐  [发送] │  ← 输入区
│  │ 输入你的问题...    │         │
│  └───────────────────┘         │
└─────────────────────────────────┘
```

### 4.2 设计规范

#### 色彩搭配方案

**主色调 - 科技绿**

- `#00ff88` - 主色调(绿色),用于标题、高亮文字、按钮等
- `#00cc6a` - 深绿色,用于渐变和阴影效果

**背景色系 - 深色主题**

- `#1a1a1a` - 主背景色(深灰色)
- `#2d2d2d` - 次级背景色
- `rgba(45, 45, 45, 0.8)` - 半透明卡片背景

**文字色彩**

- `#ffffff` - 主文字色(白色)
- `rgba(255, 255, 255, 0.9)` - 次级文字色
- `rgba(255, 255, 255, 0.7)` - 提示文字色

#### 交互反馈

- **输入中**: 显示"..."动画
- **发送中**: 按钮禁用
- **错误**: 红色提示消息
- **成功**: 消息渐入动画